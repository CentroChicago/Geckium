:root {
	--titlebar-active: linear-gradient(
		to bottom,
		rgb(97, 162, 241),
		rgb(72, 140, 222) 40px
	);
	--titlebar-inactive: linear-gradient(
		to bottom,
		rgb(163, 201, 247),
		rgb(147, 186, 234) 40px
	);
	
	@media (-moz-platform: linux) {
		--titlebar-active: linear-gradient(
			to bottom,
			color-mix(
				in srgb,
				ActiveCaption 90%,
				white
			),
			ActiveCaption 40px
		) !important;

		--titlebar-inactive: linear-gradient(
			to bottom,
			color-mix(
				in srgb,
				InactiveCaption 90%,
				white
			),
			InactiveCaption 40px
		) !important;
	}

    &[privatebrowsingmode="temporary"] {
        --titlebar-active: linear-gradient(
            to bottom,
            rgb(97, 122, 156),
            rgb(80, 105, 141) 40px
        ) !important;
        --titlebar-inactive: linear-gradient(
            to bottom,
            rgb(147, 161, 178),
            rgb(128, 143, 161) 40px
        ) !important;

        #fxa-toolbar-menu-button {
            display: none !important;
        }
    }

    @import "titlebar/nocomp";
	&:not(:-moz-lwtheme) {
		&[windowtype="navigator:browser"] > body {
			background: transparent !important;

			@media (-moz-platform: linux) {
				background: var(--titlebar-active) !important;

				&:-moz-window-inactive {
					background: var(--titlebar-inactive) !important;
				}
			}
		}
	}
    &:-moz-lwtheme {
        /* bruni: This entire code takes care of custom themes support for titlebar */

		#navigator-toolbox {
			padding-top: 0 !important;
		}

        &:not([lwtheme-id*="firefox-compact"]) {
			&:not([lwtheme-id="#{$gtkplus}"]) {
				&:not([privatebrowsingmode="temporary"]),
				&[privatebrowsingmode="temporary"] {
					--titlebar-active: var(--lwt-accent-color) !important;
					--titlebar-inactive: var(--titlebar-active) !important;
				}

				// Themes with image header/additional images
				&[windowtype="navigator:browser"] > body {
					&::before {
						content: "";
						position: absolute;
						top: 1px;
						left: 1px;
						height: calc(24px + var(--tab-height) + var(--nav-bar-height) + var(--personal-toolbar-height));
						width: calc(100% - 2px);
						border-radius: 5px 5px 0 0;

						box-shadow: inset 1px 1px 0 0 rgba(255, 255, 255, 0.25);
						background-color: var(--lwt-accent-color);
						background-image: var(--lwt-additional-images);
						background-repeat: var(--lwt-background-tiling);
						background-position: var(--lwt-background-alignment);
						background-position-y: -9px;
					}
				}

				&[style*="--lwt-background-alignment: right center"] {
					&[windowtype="navigator:browser"] > body {
						&::before {
							background-position-y: calc(50% - 9px);
						}
					}
				}

				&[sizemode="maximized"],
				&[sizemode="fullscreen"] {
					&[windowtype="navigator:browser"] > body {
						&::before {
							box-shadow: 0;
							top: -9px;
						}
					}
				}

				&[lwtheme-image] {
					&[windowtype="navigator:browser"] > body {
						position: relative;

						&::before {
							background-image: var(--lwt-header-image, linear-gradient(transparent, transparent)), var(--lwt-additional-images) !important;
							background-repeat: no-repeat, var(--lwt-background-tiling);
							background-position: right top, var(--lwt-background-alignment);
							background-position-y: -9px;
							box-shadow: inset 1px 1px 0 0 rgba(255, 255, 255, 0.25);
						}
					}

					#navigator-toolbox {
						box-shadow: none !important;
					}
				}

				// Themes without image header/additional images
				&:not([style*="--lwt-additional-images"]) {
					&:not([style*="--lwt-header-image"]) {
						&:not([privatebrowsingmode="temporary"]),
						&[privatebrowsingmode="temporary"] {
							--titlebar-active: linear-gradient(
								to bottom,
								color-mix(
									in srgb,
									var(--lwt-accent-color) 90%,
									white
								),
								var(--lwt-accent-color) 40px
							) !important;
							--titlebar-inactive: linear-gradient(
								to bottom,
								color-mix(
									in srgb,
									var(--lwt-accent-color) 70%,
									white
								),
								color-mix(
									in srgb,
									var(--lwt-accent-color) 80%,
									white
								)
							) !important;
						}

						&[windowtype="navigator:browser"] > body {
							&::before {
								content: unset;
							}
						}
					}
				}
	
				&[customthememode="1"] {
					&[windowtype="navigator:browser"] > body,
					#navigator-toolbox {
						background: transparent !important;
					}

					&[windowtype="navigator:browser"] > body {
						&::before {
							content: unset;
						}
					}
				}
			}
        }

        /* bruni: Firefox is weird, if we set the root to be transparent,
				  then it takes body's background. The lowest we can go in
				  alpha is 0.002 for that bug (assuming it's one) to not happen. */
		background: rgba(1, 1, 1, 0.002) !important;
		
		@media not (-moz-ev-native-controls-patch) {
			background: white !important;
		}
    }
}

#private-browsing-indicator-with-label {
    align-items: end !important;
    margin-inline: 0 !important;
    margin-inline-start: 5px !important;
    margin-inline-end: -4px !important;
}

.private-browsing-indicator-icon {
    list-style-image: url("chrome://userchrome/content/assets/img/titlebar/otr_icon.png") !important;
    width: auto !important;
    height: auto !important;
}

[data-l10n-id="private-browsing-indicator-label"] {
    display: none !important;
}
