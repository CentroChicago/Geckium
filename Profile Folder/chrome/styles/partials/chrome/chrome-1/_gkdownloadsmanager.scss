@keyframes gkDownloadsPaneShow {
	0% {
		clip-path: polygon(0 0, 100% 0, 100% 0, 0 0);
		margin-block-end: calc(var(--gkdownloads-pane-height) * -1);
	}
	100% {
		clip-path: polygon(0 -800%, 100% -800%, 100% 100%, 0 100%);
		margin-block-end: 0;
	}
}

@keyframes gkDownloadsPaneHide {
	0% {
		clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
		margin-block-end: 0;
	}
	100% {
		clip-path: polygon(0 0, 100% 0, 100% 0, 0 0);
		margin-block-end: calc(var(--gkdownloads-pane-height) * -1);
	}
}

@keyframes gkDownloadsItemStart {
	0% {
		max-width: 0px;
	}
	100% {
		max-width: var(--gkdownloads-item-max-width);
	}
}

@keyframes gkDownloadsBegin {
	0% {
		opacity: 1;
		top: -230px;
	}
	100% {
		opacity: 0;
		top: -135px;
	}
}

@keyframes gkDownloadsProgressDone {
	0% {
		opacity: 1;
	}
	20% {
		opacity: 0;
	}
	40% {
		opacity: 1;
	}
	60% {
		opacity: 0;
	}
	80% {
		opacity: 1;
	}
	100% {
		opacity: 0;
	}
}

:root {
	--gkdownloads-pane-height: 43px;
	--default-gkdownloads-pane-border-color: #D6D6D6;
	--gkdownloads-pane-border-color: var(--default-gkdownloads-pane-border-color);
	--default-gkdownloads-pane-background: #D2E1F6;
	--gkdownloads-pane-background: var(--default-gkdownloads-pane-background);
	--default-gkdownloads-pane-foreground-color: #123272;
	--gkdownloads-pane-foreground-color: var(--default-gkdownloads-pane-foreground-color);
	--gkdownloads-pane-animation-toggle-duration: .1s;

	--gkdownloads-item-animation-begin-duration: .8s;
	--gkdownloads-item-animation-grow-duration: .45s;
	--gkdownloads-item-box-shadow-normal: 0px 0px 1px rgba(0,0,0,.1);
	--gkdownloads-item-box-shadow-hot: 0px 0px 1px rgba(0,0,0,.2);
	--gkdownloads-item-main-box-shadow-active: 0px 0px 1px rgba(0,0,0,.2);
	--gkdownloads-item-border-radius: 6px;
	--gkdownloads-item-height: 36px;
	--gkdownloads-item-max-width: 206px;
	--default-gkdownloads-item-border-color-normal: rgba(0,0,0,.14);
	--gkdownloads-item-border-color-normal: var(--default-gkdownloads-item-border-color-normal);
	--default-gkdownloads-item-border-color-hot: var(--gkdownloads-item-border-color-normal	);
	--gkdownloads-item-border-color-hot: var(--default-gkdownloads-item-border-color-hot);
	--default-gkdownloads-item-border-color-active: rgba(255,255,255,.2);
	--gkdownloads-item-border-color-active: var(--default-gkdownloads-item-border-color-active);
	--gkdownloads-item-separator-color-normal: #CFDBEC;
	--gkdownloads-item-separator-color-active: #A8C6EE;
	--default-gkdownloads-item-background-normal: linear-gradient(
		to bottom,
		rgba(255,255,255,.3),
		rgba(238,245,252,.3)
	);
	--gkdownloads-item-background-normal: var(--default-gkdownloads-item-background-normal);
	--default-gkdownloads-item-background-hot: linear-gradient(
		to bottom,
		rgba(255,255,255,.4),
		rgba(248,250,255,.4)
		
	);
	--gkdownloads-item-background-hot: var(--default-gkdownloads-item-background-hot);
	--default-gkdownloads-item-main-background-active: linear-gradient(
		to bottom,
		rgba(255,255,255,.2),
		rgba(240,245,255,.2)
	);
	--gkdownloads-item-main-background-active: var(--default-gkdownloads-item-main-background-active);
	--gkdownloads-item-inset-border-color-normal: rgba(255,255,255,.21);
	--gkdownloads-item-inset-border-color-hot: rgba(255,255,255,.3);
	--gkdownloads-item-inset-border-color-active: rgba(0,0,0,.18);
	--gkdownloads-item-progress-color: #8FDF5F;
	--gkdownloads-item-description-color-normal: #556C9A;
	--gkdownloads-item-description-color-hot: #96A4C2;
	--gkdownloads-item-description-color-active: #8899BA;
	--gkdownloads-item-more-icon-color: #516D9F;
	--gkdownloads-item-transition-duration: .1s;

	--gkdownloads-pane-close-color-normal: #454B51;
	--gkdownloads-pane-close-color-hot: #2B2E32;
	--gkdownloads-pane-close-color-active: #111214;

	/*
		Chromium Themes
	*/

	&[gkthemed][gkchrthemed] {
		&[gkchrthemehasdownloadbar] {
			--gkdownloads-pane-background: var(--chrtheme-downloadbar, var(--default-gkdownloads-pane-background));
			--gkdownloads-pane-foreground-color: var(--chrtheme-bookmark-text, var(--default-gkdownloads-pane-foreground-color));

			#gkDownloadsPane {
				background-position-y: calc((var(--tab-height) + var(--nav-bar-height) + var(--personal-toolbar-height)) * -1);
			}
		}
	}
}

#gkDownloadsPane,
#gkDownloadsList,
#gkDownloadsActionButtons {
	display: flex;
}

#gkDownloadsPane {
	display: flex !important;
	box-sizing: border-box;
	height: var(--gkdownloads-pane-height);
	padding-inline-end: 16px;
	border-block-start: 1px solid var(--gkdownloads-pane-border-color);
	background: var(--gkdownloads-pane-background);

	pointer-events: none;
	clip-path: polygon(0 0, 100% 0, 100% 0, 0 0);
	margin-block-end: calc(var(--gkdownloads-pane-height) * -1);

	&[hidden="true"] {
		pointer-events: none;
		animation: gkDownloadsPaneHide var(--gkdownloads-pane-animation-toggle-duration) ease-out forwards;
	}
	&[hidden="false"] {
		pointer-events: all	;
		animation: gkDownloadsPaneShow var(--gkdownloads-pane-animation-toggle-duration) ease-out forwards;
	}

	button,
	toolbarbutton {
		appearance: none !important;
		margin: 0 !important;
		min-width: 0 !important;
		padding: 0 !important;
	}
}

#gkDownloadsList {	
	flex: 1;

	margin-inline: 3px;
	margin-block-start: 2px;
	margin-block-end: 3px;
	gap: 2px;

	> .item {
		position: relative;
		width: 100%;
		height: var(--gkdownloads-item-height);
		border-radius: var(--gkdownloads-item-border-radius);
		// overflow: hidden;
		max-width: 0;
		animation: gkDownloadsItemStart var(--gkdownloads-item-animation-grow-duration) ease-out forwards;

		&::before {
			content: url("chrome://userchrome/content/assets/img/chrome-1/downloadspane/download_animation_begin.png");
			position: absolute;
			top: -230px;
			opacity: 1;
			animation: gkDownloadsBegin var(--gkdownloads-item-animation-begin-duration) ease-out forwards;
		}

		&[data-state="canceled"],
		&[data-state="error"] {
			.progress-container > [class*="progress"] {
				display: none;
			}
		}

		&[data-state="done"] {
			.description {
			display: none;
			}

			.progress-container > [class*="progress"] {
				animation: gkDownloadsProgressDone 2.5s linear forwards;
			}
		}

		.progress-container,
		.progress-container > [class*="progress"] {
			top: 0;
			left: 0;
			width: 30px;
			height: 30px;
			position: absolute;
			background-position: center;
			background-size: cover;
		}

		.progress-container {
			display: flex;
			position: relative;
			align-items: center;
			justify-content: center;
			flex-shrink: 0;

			> .progress-bg {
				background-image: url("chrome://userchrome/content/assets/img/chrome-1/downloadspane/progress_bg.svg");
			}

			> .progress-mask {
				background-image: url("chrome://userchrome/content/assets/img/chrome-1/downloadspane/progress_mask.svg");
				-moz-context-properties: fill, fill-opacity;
				fill: var(--gkdownloads-item-progress-color);
				mask-image: conic-gradient(white var(--gkdownload-progress), transparent var(--gkdownload-progress));
			}

			> .icon {
				width: 16px;
				height: 16px;
				z-index: 1;
			}
		}

		> .main,
		> .more {
			position: relative;
			border-width: 1px;
			border-style: solid;
			border-block-color: var(--gkdownloads-item-border-color-normal);
			//background: var(--gkdownloads-item-background-normal);
			//box-shadow: var(--gkdownloads-item-box-shadow-normal);
			overflow: hidden !important;

			transition: border-color var(--gkdownloads-item-transition-duration), box-shadow var(--gkdownloads-item-transition-duration);

			&::after {
				content: "";
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				border-block-start-width: 1px;
				border-block-start-style: solid;
				border-color: var(--gkdownloads-item-inset-border-color-normal);
				transition: border-color var(--gkdownloads-item-transition-duration)
			}

			> .background {
				position: absolute;
				width: 100%;
				height: 100%;
				pointer-events: none;

				~ * {
					z-index: 1;
				}

				> * {
					position: absolute;
					opacity: 0;
					width: 100%;
					height: 100%;
					transition: opacity var(--gkdownloads-item-transition-duration);

					&.normal {
						opacity: 1;
						background: var(--gkdownloads-item-background-normal);
					}

					&.hot {
						background: var(--gkdownloads-item-background-hot);
						box-shadow: var(--gkdownloads-item-box-shadow-hot);
					}
				}
			}

			&:not(
				[open="true"],
				:active
			) {
				&::after {
					border-color: var(--gkdownloads-item-inset-border-color-hot);
				}

				&:hover {
					border-block-color: var(--gkdownloads-item-border-color-hot);
					box-shadow: var(--gkdownloads-item-box-shadow-hot);

					> .background {
						> .normal,
						> .active {
							opacity: 0;
						}

						> .hot {
							opacity: 1;
						}
					}
				}
			}

			&:active,
			&[open="true"] {
				transition: border-color 0s, box-shadow 0s;

				&::after {
					border-color: var(--gkdownloads-item-inset-border-color-active);
					transition: border-color 0s;
				}

				> .background {
					> * {
						transition: opacity 0s;
					}

					> .normal,
					> .hot {
						opacity: 0;
					}

					> .active {
						opacity: 1;
					}
				}
			}
		}

		> .main {
			border-top-left-radius: var(--gkdownloads-item-border-radius);
			border-bottom-left-radius: var(--gkdownloads-item-border-radius);
			border-inline-start-color: var(--gkdownloads-item-border-color-normal);
			border-inline-end-width: 0;
			padding-inline: 2px !important;
			justify-content: center;
			gap: 6px;
			align-items: center;
			min-width: 46px !important;

			&::after {
				pointer-events: none;
				border-top-left-radius: var(--gkdownloads-item-border-radius);
				border-bottom-left-radius: var(--gkdownloads-item-border-radius);
				border-inline-start-width: 1px;
				border-inline-start-style: solid;
			}

			&:not(:active) {
				&:hover {
					border-inline-start-color: var(--gkdownloads-item-border-color-hot);
	
					.description {
						color: var(--gkdownloads-item-description-color-hot);
					}
				}
			}

			&:active {
				border-block-color: var(--gkdownloads-item-border-color-active);
				border-inline-start-color: var(--gkdownloads-item-border-color-active);
				//background: var(--gkdownloads-item-main-background-active);
				box-shadow: var(--gkdownloads-item-main-box-shadow-active);

				.description {
					color: var(--gkdownloads-item-description-color-active);
				}
			}

			> .background > .active {
				background: var(--gkdownloads-item-main-background-active);
				box-shadow: var(--gkdownloads-item-main-box-shadow-active);
			}
			
			> .info {               
				overflow: hidden;
			}
		}

		> .more {
			border-top-right-radius: var(--gkdownloads-item-border-radius);
			border-bottom-right-radius: var(--gkdownloads-item-border-radius);
			border-inline-start-width: 0;
			border-inline-end-color: var(--gkdownloads-item-border-color-normal);
			align-items: center;
			width: 15px;
			list-style-image: url("chrome://userchrome/content/assets/img/chrome-1/downloadspane/arrow.svg");
			-moz-context-properties: fill, fill-opacity;
			fill: var(--gkdownloads-item-more-icon-color);

			&::after {
				border-top-right-radius: var(--gkdownloads-item-border-radius);
				border-bottom-right-radius: var(--gkdownloads-item-border-radius);
			}

			&:not([open="true"]) {
				&:hover {
					border-inline-end-color: var(--gkdownloads-item-border-color-hot);

					> .separator {
						border-inline-start-color: rgba(0,0,0,.32);
						border-inline-end-color: rgba(255,255,255,.09);
					}
				}
			}
			
			&:active,
			&[open="true"] {
				border-block-color: var(--gkdownloads-item-border-color-active);
				border-inline-end-color: var(--gkdownloads-item-border-color-active);

				> .separator {
					border-inline-start-color: rgba(0,0,0,.26);
					border-inline-end-color: rgba(0,0,0,.01);
					transition: border-color 0s;
				}
			}

			> .background > .active {
				background: var(--gkdownloads-item-background-normal);
			}

			> .separator {
				position: absolute;
				pointer-events: none;
				left: 0;
				top: 1px;
				height: calc(100% - 2px);
				border-inline-start-width: 1px;
				border-inline-start-style: solid;
				border-inline-start-color: rgba(0,0,0,.26);
				border-inline-end-width: 1px;
				border-inline-end-style: solid;
				border-inline-end-color: rgba(255,255,255,.06);
				transition: border-color var(--gkdownloads-item-transition-duration)
			}
			
			image {
				filter: drop-shadow(0px 1px 0px rgba(255, 255, 255, .75));
			}

			.toolbarbutton-text {
				display: none !important;
			}
		}

		label {
			margin: 0 !important;
			white-space: nowrap;
			text-overflow: ellipsis;
			overflow: hidden;

			&.name {
				color: var(--gkdownloads-pane-foreground-color);
			}
		}

		.description {
			display: inherit;   
			color: var(--gkdownloads-item-description-color-normal);
		}
	}
}

#gkDownloadsActionButtons {
	align-items: center;
	gap: 15px;
}

#gkDownloadsPaneShowAll {
	list-style-image: url("chrome://userchrome/content/assets/img/chrome-1/downloadspane/downloads_favicon.svg");
	color: var(--gkdownloads-pane-foreground-color) !important;
	text-decoration: underline;
	white-space: nowrap;
	cursor: pointer;

	.button-box {
		gap: 5px;

		> * {
			margin: 0 !important;
		}
	}
}

#gkDownloadsPaneToggle {
	width: 16px;
	height: 16px;
	list-style-image: url("chrome://userchrome/content/assets/img/chrome-1/downloadspane/close.svg");
	-moz-context-properties: fill, fill-opacity;
	fill: var(--gkdownloads-pane-close-color-normal);
	transition: fill .1s;

	&:hover {
		fill: var(--gkdownloads-pane-close-color-hot);
	}

	&:active {
		fill: var(--gkdownloads-pane-close-color-active);
	}

	label {
		display: none;
	}
}